<span data-controller="nested-form" class="block w-full">
  <% content_for :packaging_materials_fields, flush: true do %>

    <% fields_for_object = local_assigns[:order_content].new_record? ? PackagingMaterial.new : local_assigns[:order_content].packaging_materials %>

    <%= local_assigns[:form].fields_for :packaging_materials, fields_for_object, child_index: 'TEMPLATE_RECORD' do |ff| %>
      <%= ff.hidden_field :id %>
      <div data-nested-form-target="nestedField" class="bg-gray-50 py-3 flex justify-around">
        <div class="mx-auto">
          <%= ff.label :type, 'Type', class: "text-sm font-medium" %>
          <br>
          <%= ff.select :type, PackagingMaterialDecorator.types_options, {}, { class: "hover:cursor-pointer rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm"} %>
        </div>
        <div class="mx-auto">
          <%= ff.label :description, "Description", class: "text-sm font-medium" %>
          <br>
          <%= ff.text_field :description, data: { "nested-form-target": "descriptionField"}, class: "hover:cursor-pointer rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm" %>
        </div>
        <div class="mx-auto">
          <%= ff.check_box :_destroy, class: "hidden" %>
          <br>
          <%= link_to "Remove", "#", data: { "nested-form-target": "removeNestedFieldBtn", action: "click->nested-form#remove_association" }, class:'text-red-600 font-bold h-full' %>
        </div>
      </div>
    <% end %>
  <% end %>
  <% content_for :add_item_button, flush: true do %>
    <%= link_to "Add packaging material", "#", data: { "nested-form-target": "addItem", action: "nested-form#add_association" }, class: "inline-block w-full mb-3 cursor-pointer rounded-md py-2 px-3 text-center text-sm font-semibold leading-6 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 text-indigo-500 hover:text-indigo-600 ring-1 ring-inset ring-indigo-200 hover:ring-indigo-300" %>
  <% end %>
  <div class="">
    <div class="mx-auto">
      <div class="block w-full">
        <%= yield :add_item_button %>
      </div>
      <div class="inline-block w-full">
        <div class="grid">
          <% if local_assigns[:form].object.new_record? %>
            <template data-nested-form-target="template">
              <%= yield :packaging_materials_fields %>
            </template>
          <% else %>
            <%= yield :packaging_materials_fields %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</span>
